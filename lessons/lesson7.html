<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—Ä–æ–∫ 7: –ü—Ä–∏—Ä–æ–¥–Ω—ã–µ —Ç—Ä–æ–ø—ã</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #558b2f;
            --dark: #33691e;
            --accent: #aed581;
            --bg: #f1f8e9;
            --white: #ffffff;
            --brown: #795548;
            --path: #8d6e63;
        }

        body { 
            font-family: 'Segoe UI', system-ui, sans-serif; 
            line-height: 1.6; 
            color: #333; 
            background-color: var(--bg); 
            margin: 0; 
            background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><g fill="%23c5e1a5" fill-opacity="0.4"><path d="M10 10h10v10H10zM50 50h10v10H50z"/></g></svg>');
        }

        header { 
            background: linear-gradient(135deg, var(--dark), var(--primary)); 
            color: white; 
            padding: 25px 5%; 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border-radius: 0 0 20px 20px;
        }

        .back-btn { 
            color: white; 
            text-decoration: none; 
            font-weight: bold; 
            border: 2px solid rgba(255,255,255,0.7); 
            padding: 8px 20px; 
            border-radius: 25px; 
            transition: 0.3s;
        }
        .back-btn:hover { background: white; color: var(--dark); border-color: white; }

        .content { max-width: 1000px; margin: 40px auto; padding: 0 20px; }

        section { 
            background: var(--white); 
            padding: 30px; 
            border-radius: 20px; 
            margin-bottom: 30px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            border: 1px solid #dcedc8;
        }

        h2 { color: var(--dark); border-bottom: 3px solid var(--accent); padding-bottom: 10px; display: inline-block; margin-top: 0; }
        h3 { color: var(--primary); margin-top: 20px; }

        /* –ê—Ç–ª–∞—Å —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ç—Ä–æ–ø—ã */
        .elements-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .flip-card { background-color: transparent; height: 220px; perspective: 1000px; cursor: pointer; }
        .flip-card-inner { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s; transform-style: preserve-3d; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 15px; }
        .flip-card:hover .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 15px; display: flex; align-items: center; justify-content: center; flex-direction: column; }
        .flip-card-front { background: white; border: 2px solid var(--primary); color: var(--dark); }
        .flip-card-front span { font-size: 3rem; margin-bottom: 10px; }
        .flip-card-back { background: var(--primary); color: white; transform: rotateY(180deg); padding: 15px; box-sizing: border-box; }

        /* –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ç—Ä–æ–ø—ã */
        .builder-area {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .toolbar {
            flex: 1;
            background: #f1f8e9;
            padding: 15px;
            border-radius: 10px;
            border: 2px dashed #aed581;
        }
        .map-canvas {
            flex: 2;
            height: 300px;
            background: #e8f5e9 url('data:image/svg+xml;utf8,<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="2" cy="2" r="1" fill="%23ccc"/></svg>');
            border: 2px solid #33691e;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }
        .draggable-item {
            background: white;
            padding: 8px 12px;
            margin: 5px;
            border-radius: 5px;
            cursor: grab;
            border: 1px solid #ccc;
            display: inline-block;
            font-size: 0.9rem;
        }
        .map-point {
            position: absolute;
            cursor: move;
            background: white;
            padding: 5px;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            border: 2px solid var(--primary);
            font-size: 1.5rem;
        }

        /* –í–∏–¥–µ–æ */
        .video-wrapper { border-radius: 15px; overflow: hidden; position: relative; padding-bottom: 56.25%; height: 0; margin: 20px 0; border: 4px solid var(--dark); }
        .video-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

        /* –†–∞–±–æ—á–∏–µ –ª–∏—Å—Ç—ã */
        details.worksheet { background: var(--white); border: 1px solid #ccc; border-radius: 8px; margin-bottom: 15px; overflow: hidden; }
        summary.worksheet-header { background: #f1f8e9; padding: 15px; cursor: pointer; font-weight: bold; color: var(--dark); list-style: none; display: flex; justify-content: space-between; align-items: center; }
        summary.worksheet-header:hover { background: #dcedc8; }
        summary.worksheet-header::after { content: '‚ñº'; font-size: 0.8em; }
        details[open] summary.worksheet-header::after { content: '‚ñ≤'; }
        .sheet-content { padding: 20px; border-top: 1px solid #eee; background: #fff; }
        .sheet-input { border: none; border-bottom: 2px solid #aaa; background: #f9f9f9; width: 200px; font-family: inherit; padding: 5px; transition: 0.3s; }
        .sheet-input:focus { border-bottom-color: var(--primary); outline: none; background: #e8f5e9; }
        textarea.sheet-area { width: 100%; height: 80px; border: 1px solid #ccc; border-radius: 5px; padding: 10px; margin-top: 5px; font-family: inherit; resize: vertical; background: #fcfcfc; }
        
        .btn-download { background: var(--brown); color: white; border: none; padding: 15px 30px; border-radius: 30px; cursor: pointer; width: 100%; font-size: 1.1rem; font-weight: bold; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 5px 15px rgba(121, 85, 72, 0.4); transition: 0.3s; margin-top: 20px; }
        .btn-download:hover { background: #5d4037; transform: translateY(-2px); }

        /* –†–µ—Ñ–ª–µ–∫—Å–∏—è */
        .thoughts-cloud { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; padding: 20px; }
        .thought-bubble { background: white; padding: 15px 25px; border-radius: 20px 20px 20px 0; box-shadow: 2px 2px 10px rgba(0,0,0,0.1); cursor: pointer; border: 2px solid #ddd; transition: 0.2s; max-width: 250px; font-weight: bold; }
        .thought-bubble:active { transform: scale(0.95); background: #eee; }
        .thought-bubble:hover { border-color: var(--primary); color: var(--primary); }
        .btn-clear { background: #9e9e9e; color: white; border: none; padding: 8px 20px; border-radius: 20px; cursor: pointer; font-size: 0.9rem; transition: 0.2s; margin-top: 20px; }
        .btn-clear:hover { background: #757575; }
    </style>
</head>
<body>

<header>
    <a href="../index.html" class="back-btn">‚Üê –ú–µ–Ω—é</a>
    <div style="text-align: right">
        <h1 style="margin:0; font-size: 1.5rem;">–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ —Ç—Ä–æ–ø—ã</h1>
        <small>–£—Ä–æ–∫ ‚Ññ7</small>
    </div>
</header>

<div class="content">
    
    <section>
        <h2>üå≤ –ó–∞—á–µ–º —Ç—Ä–æ–ø—ã –≤ –ª–µ—Å—É?</h2>
        <p><i>–í–æ–ø—Ä–æ—Å:</i> –ü–æ—á–µ–º—É –º—ã —Ö–æ–¥–∏–º –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º —Ç—Ä–æ–ø–∏–Ω–∫–∞–º, –∞ –Ω–µ –±–µ–∂–∏–º –Ω–∞–ø—Ä—è–º–∏–∫ —á–µ—Ä–µ–∑ –∫—É—Å—Ç—ã?</p>
        <div style="background: #e8f5e9; padding: 15px; border-radius: 10px; border-left: 5px solid var(--primary);">
            <strong>–¶–µ–ª—å:</strong> –£–∑–Ω–∞—Ç—å, –∫–∞–∫ —ç–∫–æ—Ç—Ä–æ–ø–∞ —Å–ø–∞—Å–∞–µ—Ç –ª–µ—Å –∏ —É—á–∏—Ç –ª—é–¥–µ–π.
        </div>
        <h3>üìπ –í–∏–¥–µ–æ: –ß—Ç–æ —Ç–∞–∫–æ–µ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Ç—Ä–æ–ø–∞?</h3>
        <div class="video-wrapper">
            <iframe src="https://www.youtube.com/embed/13hRVAVIJ5s" title="–≠–∫–æ—Ç—Ä–æ–ø–∞" frameborder="0" allowfullscreen></iframe>
        </div>
    </section>

    <section>
        <h2>üõ†Ô∏è –ò–∑ —á–µ–≥–æ —Å–æ—Å—Ç–æ–∏—Ç —Ç—Ä–æ–ø–∞?</h2>
        <p>–ù–∞–≤–µ–¥–∏—Ç–µ –∫—É—Ä—Å–æ—Ä –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞:</p>
        <div class="elements-grid">
            <div class="flip-card"><div class="flip-card-inner"><div class="flip-card-front"><span>üõë</span><h3>–ê–Ω—à–ª–∞–≥</h3></div><div class="flip-card-back"><p>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —â–∏—Ç –≤ –Ω–∞—á–∞–ª–µ —Ç—Ä–æ–ø—ã. –†–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ä—Ç—É.</p></div></div></div>
            <div class="flip-card"><div class="flip-card-inner"><div class="flip-card-front"><span>üåâ</span><h3>–ù–∞—Å—Ç–∏–ª</h3></div><div class="flip-card-back"><p>–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π –º–æ—Å—Ç–∏–∫. –ó–∞—â–∏—â–∞–µ—Ç –ø–æ—á–≤—É –æ—Ç –≤—ã—Ç–∞–ø—Ç—ã–≤–∞–Ω–∏—è —Ç—É—Ä–∏—Å—Ç–∞–º–∏.</p></div></div></div>
            <div class="flip-card"><div class="flip-card-inner"><div class="flip-card-front"><span>üî≠</span><h3>–°–º–æ—Ç—Ä–æ–≤–∞—è</h3></div><div class="flip-card-back"><p>–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø–ª–æ—â–∞–¥–∫–∞ –¥–ª—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∑–∞ –ø—Ç–∏—Ü–∞–º–∏ –∏–ª–∏ –ø–∞–Ω–æ—Ä–∞–º–æ–π.</p></div></div></div>
            <div class="flip-card"><div class="flip-card-inner"><div class="flip-card-front"><span>üé®</span><h3>–ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞</h3></div><div class="flip-card-back"><p>–¶–≤–µ—Ç–Ω—ã–µ –º–µ—Ç–∫–∏ –Ω–∞ –¥–µ—Ä–µ–≤—å—è—Ö, —á—Ç–æ–±—ã —Ç—É—Ä–∏—Å—Ç—ã –Ω–µ –∑–∞–±–ª—É–¥–∏–ª–∏—Å—å.</p></div></div></div>
        </div>
    </section>

    <section>
        <h2>üó∫Ô∏è –ú–∏–Ω–∏-–∏–≥—Ä–∞ ¬´–ü–æ—Å—Ç—Ä–æ–π —Å–≤–æ—é —Ç—Ä–æ–ø—É¬ª</h2>
        <p>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –æ–±—ä–µ–∫—Ç—ã –Ω–∞ –∫–∞—Ä—Ç—É, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç—É, —á—Ç–æ–±—ã –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ—á–∫—É.</p>
        <div class="builder-area">
            <div class="toolbar">
                <h4>–û–±—ä–µ–∫—Ç—ã:</h4>
                <div class="draggable-item" draggable="true" ondragstart="drag(event)" id="obj1">üå≤ –õ–µ—Å</div>
                <div class="draggable-item" draggable="true" ondragstart="drag(event)" id="obj2">üåä –†—É—á–µ–π</div>
                <div class="draggable-item" draggable="true" ondragstart="drag(event)" id="obj3">üõë –°—Ç–µ–Ω–¥</div>
                <div class="draggable-item" draggable="true" ondragstart="drag(event)" id="obj4">üèïÔ∏è –ü—Ä–∏–≤–∞–ª</div>
                <div class="draggable-item" draggable="true" ondragstart="drag(event)" id="obj5">üî≠ –û–±–∑–æ—Ä</div>
                <p><small>–ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –∫–∞—Ä—Ç–µ, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –æ–±—ä–µ–∫—Ç.</small></p>
                <button onclick="clearMap()" style="width:100%; margin-top:10px; padding:5px; cursor:pointer;">–û—á–∏—Å—Ç–∏—Ç—å –∫–∞—Ä—Ç—É</button>
            </div>
            <div class="map-canvas" id="map" ondrop="drop(event)" ondragover="allowDrop(event)" onclick="addPointClick(event)">
                </div>
        </div>
    </section>

    <section id="worksheets-container">
        <h2>üìù –†–∞–±–æ—á–∏–µ –ª–∏—Å—Ç—ã (–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–¥–µ—Å—å)</h2>
        <p>–í–ø–∏—à–∏—Ç–µ –æ—Ç–≤–µ—Ç—ã –∏ —Å–∫–∞—á–∞–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π Word-—Ñ–∞–π–ª.</p>

        <details class="worksheet" open>
            <summary class="worksheet-header">üìÑ –õ–ò–°–¢ ‚Ññ1 ‚Äî ¬´–ß—Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–∏—Ä–æ–¥–Ω–∞—è —Ç—Ä–æ–ø–∞?¬ª</summary>
            <div class="sheet-content">
                <p>–§–ò–û: <input type="text" class="sheet-input"></p>
                <h3>1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ</h3>
                <textarea class="sheet-area" placeholder="–ü—Ä–∏—Ä–æ–¥–Ω–∞—è —Ç—Ä–æ–ø–∞ ‚Äî —ç—Ç–æ..."></textarea>
                <h3>2. –î–ª—è —á–µ–≥–æ –Ω—É–∂–Ω—ã —Ç—Ä–æ–ø—ã? (–û—Ç–º–µ—Ç—å)</h3>
                <div style="margin-top:10px;">
                    <label><input type="checkbox"> –û—Ö—Ä–∞–Ω–∞ –ø—Ä–∏—Ä–æ–¥—ã</label>
                    <label><input type="checkbox"> –°–±–æ—Ä –≥—Ä–∏–±–æ–≤ –≥–¥–µ —É–≥–æ–¥–Ω–æ</label>
                    <label><input type="checkbox"> –ù–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ –∂–∏–≤–æ—Ç–Ω—ã–º–∏</label>
                    <label><input type="checkbox"> –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</label>
                </div>
                <h3>3. –ü–æ—á–µ–º—É —Ç—Ä–æ–ø—ã —Å–ø–∞—Å–∞—é—Ç –ø—Ä–∏—Ä–æ–¥—É?</h3>
                <textarea class="sheet-area"></textarea>
            </div>
        </details>

        <details class="worksheet">
            <summary class="worksheet-header">üõë –õ–ò–°–¢ ‚Ññ2 ‚Äî ¬´–≠–ª–µ–º–µ–Ω—Ç—ã –∏ –ü—Ä–∞–≤–∏–ª–∞¬ª</summary>
            <div class="sheet-content">
                <h3>1. –¢–∞–±–ª–∏—Ü–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤</h3>
                <table style="width:100%; border-collapse:collapse; border:1px solid #ccc;">
                    <tr><th style="border:1px solid #ccc; padding:5px;">–≠–ª–µ–º–µ–Ω—Ç</th><th style="border:1px solid #ccc;">–ó–∞—á–µ–º –Ω—É–∂–µ–Ω?</th></tr>
                    <tr><td style="border:1px solid #ccc; padding:5px;">–ê–Ω—à–ª–∞–≥</td><td style="border:1px solid #ccc;"><input style="width:95%" type="text"></td></tr>
                    <tr><td style="border:1px solid #ccc; padding:5px;">–ú–æ—Å—Ç–∏–∫</td><td style="border:1px solid #ccc;"><input style="width:95%" type="text"></td></tr>
                    <tr><td style="border:1px solid #ccc; padding:5px;">–°–º–æ—Ç—Ä–æ–≤–∞—è</td><td style="border:1px solid #ccc;"><input style="width:95%" type="text"></td></tr>
                </table>
                <h3>2. –ß—Ç–æ –ù–ï–õ–¨–ó–Ø –¥–µ–ª–∞—Ç—å –Ω–∞ —Ç—Ä–æ–ø–µ? (5 –∑–∞–ø—Ä–µ—Ç–æ–≤)</h3>
                <textarea class="sheet-area" placeholder="1... 2..."></textarea>
            </div>
        </details>

        <details class="worksheet">
            <summary class="worksheet-header">üó∫Ô∏è –õ–ò–°–¢ ‚Ññ3 ‚Äî ¬´–ú–æ–π –ø—Ä–æ–µ–∫—Ç —Ç—Ä–æ–ø—ã¬ª</summary>
            <div class="sheet-content">
                <p>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–æ–ø—ã: <input type="text" class="sheet-input"></p>
                <h3>1. –û–ø–∏—Å–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞ (5-7 —Ç–æ—á–µ–∫)</h3>
                <textarea class="sheet-area" placeholder="–¢–æ—á–∫–∞ 1: –í—Ö–æ–¥... –¢–æ—á–∫–∞ 2: ..."></textarea>
                <h3>2. –ö–æ–≥–æ –º–æ–∂–Ω–æ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å? (–§–ª–æ—Ä–∞ –∏ –§–∞—É–Ω–∞)</h3>
                <textarea class="sheet-area"></textarea>
                <h3>3. –ü—Ä–∞–≤–∏–ª–∞ –º–æ–µ–π —Ç—Ä–æ–ø—ã</h3>
                <textarea class="sheet-area"></textarea>
            </div>
        </details>

        <button class="btn-download" onclick="generateAndDownloadWord()">
            üíæ –°–∫–∞—á–∞—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ª–∏—Å—Ç—ã (Word)
        </button>
    </section>

    <section>
        <h2 style="text-align: center;">üó£Ô∏è –†–µ—Ñ–ª–µ–∫—Å–∏—è: ¬´–õ–µ—Å–Ω–æ–π —à—ë–ø–æ—Ç¬ª</h2>
        <p style="text-align: center;">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ—Ä–∞–∑—É, –∫–æ—Ç–æ—Ä–∞—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤–∞—à —É—Ä–æ–∫:</p>
        
        <div class="thoughts-cloud">
            <div class="thought-bubble" onclick="vote(0)">¬´–Ø –ø–æ–Ω—è–ª, –∑–∞—á–µ–º –Ω—É–∂–Ω—ã —Ç—Ä–æ–ø—ã¬ª üõ§Ô∏è</div>
            <div class="thought-bubble" onclick="vote(1)">¬´–ú–Ω–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å¬ª üìê</div>
            <div class="thought-bubble" onclick="vote(2)">¬´–ë—É–¥—É —Å–æ–±–ª—é–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –≤ –ª–µ—Å—É¬ª üå≥</div>
            <div class="thought-bubble" onclick="vote(3)">¬´–•–æ—á—É —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ—é —Ç—Ä–æ–ø—É¬ª üöß</div>
        </div>
        
        <p id="vote-msg" style="text-align: center; color: var(--primary); font-weight: bold; margin-top: 10px; height: 20px;"></p>

        <div style="max-width: 500px; margin: 20px auto;">
            <canvas id="reflectionChart"></canvas>
        </div>

        <div style="text-align: center;">
            <button class="btn-clear" onclick="clearVotes()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</button>
        </div>
    </section>
</div>

<script>
    // --- –ö–û–ù–°–¢–†–£–ö–¢–û–† –¢–†–û–ü–´ ---
    let draggedItem = null;
    function drag(ev) { draggedItem = ev.target.innerText; }
    function allowDrop(ev) { ev.preventDefault(); }
    function drop(ev) {
        ev.preventDefault();
        createPoint(ev.offsetX, ev.offsetY, draggedItem);
    }
    function addPointClick(ev) {
        if(ev.target.classList.contains('map-canvas')) {
            createPoint(ev.offsetX, ev.offsetY, "üìç –¢–æ—á–∫–∞");
        }
    }
    function createPoint(x, y, text) {
        const map = document.getElementById('map');
        const point = document.createElement('div');
        point.className = 'map-point';
        point.style.left = (x - 15) + 'px';
        point.style.top = (y - 15) + 'px';
        
        // Emoji mapping
        let content = text;
        if(text.includes("–õ–µ—Å")) content = "üå≤";
        else if(text.includes("–†—É—á–µ–π")) content = "üåä";
        else if(text.includes("–°—Ç–µ–Ω–¥")) content = "üõë";
        else if(text.includes("–ü—Ä–∏–≤–∞–ª")) content = "üèïÔ∏è";
        else if(text.includes("–û–±–∑–æ—Ä")) content = "üî≠";
        else content = "üìç";
        
        point.innerText = content;
        map.appendChild(point);
    }
    function clearMap() { document.getElementById('map').innerHTML = ''; }

    // --- –ì–ï–ù–ï–†–ê–¶–ò–Ø WORD ---
    function generateAndDownloadWord() {
        const container = document.getElementById('worksheets-container');
        const clone = container.cloneNode(true);
        clone.querySelector('button').remove(); clone.querySelector('h2').remove(); clone.querySelector('p').remove();
        
        const originalInputs = container.querySelectorAll('input, textarea');
        const clonedInputs = clone.querySelectorAll('input, textarea');
        
        for (let i = 0; i < originalInputs.length; i++) {
            const org = originalInputs[i]; const cln = clonedInputs[i];
            const span = document.createElement('span');
            span.style.color = '#33691e'; span.style.fontWeight = 'bold';
            
            if (org.type === 'checkbox') { span.innerText = org.checked ? '‚òí ' : '‚òê '; cln.replaceWith(span); } 
            else { let val = org.value || "______________________"; span.innerText = val; cln.replaceWith(span); }
        }
        
        const details = clone.querySelectorAll('details');
        details.forEach(det => {
            const title = det.querySelector('summary').innerText;
            const contentDiv = document.createElement('div');
            contentDiv.innerHTML = `<h3 style="background:#eee;padding:5px;border-bottom:1px solid #000">${title}</h3>` + det.querySelector('.sheet-content').innerHTML;
            contentDiv.style.marginBottom = "30px";
            det.replaceWith(contentDiv);
        });

        const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>–û—Ç—á–µ—Ç</title></head><body>";
        const footer = "</body></html>";
        const styles = `<style>body { font-family: 'Times New Roman', serif; } table { width: 100%; border-collapse: collapse; margin: 10px 0; } td, th { border: 1px solid black; padding: 5px; } th { background-color: #f0f0f0; }</style>`;
        
        const blob = new Blob(['\ufeff', header + styles + `<h1 style="text-align:center">–û—Ç—á–µ—Ç: –ü—Ä–∏—Ä–æ–¥–Ω—ã–µ —Ç—Ä–æ–ø—ã</h1>` + clone.innerHTML + footer], { type: 'application/msword' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a'); link.href = url; link.download = '–ú–æ—è_–¢—Ä–æ–ø–∞_–£—Ä–æ–∫_7.doc'; document.body.appendChild(link); link.click(); document.body.removeChild(link);
    }

    // --- –ì–û–õ–û–°–û–í–ê–ù–ò–ï ---
    const labels = ["–ü–æ–Ω—è–ª —Å—É—Ç—å üõ§Ô∏è", "–ü–æ–Ω—Ä–∞–≤–∏–ª—Å—è –ø—Ä–æ–µ–∫—Ç üìê", "–ë—É–¥—É —Å–æ–±–ª—é–¥–∞—Ç—å üå≥", "–•–æ—á—É —Å–æ–∑–¥–∞—Ç—å üöß"];
    let votes = JSON.parse(localStorage.getItem('lesson7_votes')) || [0, 0, 0, 0];
    let myChart;

    function initChart() {
        const ctx = document.getElementById('reflectionChart').getContext('2d');
        myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: '–ì–æ–ª–æ—Å–∞',
                    data: votes,
                    backgroundColor: ['#c5e1a5', '#aed581', '#81c784', '#66bb6a'],
                    borderColor: '#33691e',
                    borderWidth: 1
                }]
            },
            options: { scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } }, plugins: { legend: { display: false } } }
        });
    }

    function vote(index) {
        votes[index]++;
        localStorage.setItem('lesson7_votes', JSON.stringify(votes));
        myChart.data.datasets[0].data = votes;
        myChart.update();
        const msg = document.getElementById('vote-msg');
        msg.innerText = "–®—ë–ø–æ—Ç —É—Å–ª—ã—à–∞–Ω...";
        setTimeout(() => { msg.innerText = ""; }, 1500);
    }

    function clearVotes() {
        if(confirm("–û—á–∏—Å—Ç–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ?")) {
            votes = [0, 0, 0, 0];
            localStorage.setItem('lesson7_votes', JSON.stringify(votes));
            myChart.data.datasets[0].data = votes;
            myChart.update();
        }
    }

    window.onload = initChart;
</script>

</body>
</html>