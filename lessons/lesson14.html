<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—Ä–æ–∫ 14: –ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥—ã</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #455a64; /* –°–µ—Ä–æ-—Å–∏–Ω–∏–π (–∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–π) */
            --dark: #263238;
            --accent: #ff7043; /* –¢—Ä–µ–≤–æ–∂–Ω—ã–π –æ—Ä–∞–Ω–∂–µ–≤—ã–π */
            --bg: #eceff1;
            --white: #ffffff;
            --green: #66bb6a; /* –ù–∞–¥–µ–∂–¥–∞/–ü—Ä–∏—Ä–æ–¥–∞ */
            --water: #4fc3f7;
            --air: #b0bec5;
            --soil: #8d6e63;
        }

        body { 
            font-family: 'Segoe UI', system-ui, sans-serif; 
            line-height: 1.6; 
            color: #333; 
            background-color: var(--bg); 
            margin: 0; 
            background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M0 100 L100 0" stroke="%23cfd8dc" stroke-width="2"/></svg>');
        }

        header { 
            background: linear-gradient(135deg, var(--dark), var(--primary)); 
            color: white; 
            padding: 25px 5%; 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            border-radius: 0 0 20px 20px;
        }

        .back-btn { 
            color: white; text-decoration: none; font-weight: bold; 
            border: 2px solid rgba(255,255,255,0.7); padding: 8px 20px; 
            border-radius: 25px; transition: 0.3s;
        }
        .back-btn:hover { background: white; color: var(--dark); }

        .content { max-width: 1000px; margin: 40px auto; padding: 0 20px; }

        section { 
            background: var(--white); padding: 30px; border-radius: 20px; 
            margin-bottom: 30px; box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            border-top: 5px solid var(--primary);
        }

        h2 { color: var(--dark); border-bottom: 2px solid var(--accent); padding-bottom: 10px; display: inline-block; margin-top: 0; }
        h3 { color: var(--primary); margin-top: 20px; }

        /* –ò–ì–†–ê: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä (Drag&Drop) */
        .classifier-game { display: flex; flex-direction: column; gap: 20px; }
        
        .drop-zones { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
        .zone { 
            width: 18%; min-width: 120px; min-height: 150px; 
            border: 2px dashed #999; border-radius: 10px; 
            display: flex; flex-direction: column; align-items: center; 
            padding: 10px; transition: 0.3s; background: #fafafa;
        }
        .zone h4 { margin: 0 0 10px 0; text-align: center; }
        
        /* –¶–≤–µ—Ç–∞ –∑–æ–Ω */
        .zone-air { border-color: var(--air); background: #f5f5f5; }
        .zone-water { border-color: var(--water); background: #e1f5fe; }
        .zone-soil { border-color: var(--soil); background: #efebe9; }
        .zone-noise { border-color: #ffca28; background: #fff8e1; }
        .zone-light { border-color: #ab47bc; background: #f3e5f5; }

        .draggables-pool { 
            display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; 
            background: #eee; padding: 15px; border-radius: 10px; min-height: 60px;
        }
        
        .drag-item { 
            background: white; padding: 8px 12px; border-radius: 20px; 
            cursor: grab; box-shadow: 0 2px 5px rgba(0,0,0,0.2); font-weight: bold; font-size: 0.9rem;
        }
        .drag-item:active { cursor: grabbing; }

        /* –í–ò–î–ï–û */
        .video-wrapper { border-radius: 15px; overflow: hidden; position: relative; padding-bottom: 56.25%; height: 0; margin: 20px 0; border: 4px solid var(--dark); }
        .video-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

        /* –ò–ì–†–ê: –£–≥–∞–¥–∞–π —Ñ–æ—Ç–æ (–°–ª–∞–π–¥–µ—Ä) */
        .photo-quiz { text-align: center; background: var(--bg); padding: 20px; border-radius: 15px; }
        .photo-box { 
            height: 200px; display: flex; align-items: center; justify-content: center; 
            background: #cfd8dc; font-size: 3rem; margin-bottom: 15px; border-radius: 10px; 
            border: 2px solid var(--primary);
        }
        .quiz-btns button { 
            margin: 5px; padding: 8px 15px; border: none; border-radius: 5px; 
            background: var(--white); cursor: pointer; font-weight: bold; border: 1px solid #ccc;
        }
        .quiz-btns button:hover { background: var(--accent); color: white; border-color: var(--accent); }

        /* –†–ê–ë–û–ß–ò–ï –õ–ò–°–¢–´ */
        details.worksheet { background: var(--white); border: 1px solid #ccc; border-radius: 8px; margin-bottom: 15px; overflow: hidden; }
        summary.worksheet-header { background: #cfd8dc; padding: 15px; cursor: pointer; font-weight: bold; color: var(--dark); list-style: none; display: flex; justify-content: space-between; align-items: center; }
        summary.worksheet-header:hover { background: #b0bec5; }
        summary.worksheet-header::after { content: '‚ñº'; font-size: 0.8em; }
        details[open] summary.worksheet-header::after { content: '‚ñ≤'; }
        .sheet-content { padding: 20px; border-top: 1px solid #eee; background: #fff; }
        .sheet-input { border: none; border-bottom: 2px solid #aaa; background: #f9f9f9; width: 100%; padding: 5px; margin-bottom: 5px; }
        table.sheet-table { width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 0.9rem; }
        table.sheet-table th, table.sheet-table td { border: 1px solid #aaa; padding: 8px; text-align: left; vertical-align: top; }
        table.sheet-table th { background: #eee; }
        table.sheet-table input { width: 95%; border: none; background: transparent; padding: 5px; }
        textarea.sheet-area { width: 100%; height: 60px; border: 1px solid #ccc; border-radius: 5px; padding: 10px; background: #fcfcfc; }
        .checkbox-group label { display: block; margin: 5px 0; cursor: pointer; }
        
        .btn-download { background: var(--accent); color: white; border: none; padding: 15px 30px; border-radius: 30px; cursor: pointer; width: 100%; font-size: 1.1rem; font-weight: bold; margin-top: 20px; transition: 0.3s; }
        .btn-download:hover { background: var(--dark); transform: translateY(-2px); }

        /* –¢–ï–°–¢ */
        .quiz-item { margin-bottom: 15px; padding: 15px; background: #eceff1; border-radius: 10px; border-left: 4px solid var(--accent); }
        .btn-check { background: var(--dark); color: white; border: none; padding: 10px 25px; border-radius: 20px; cursor: pointer; }

        /* –†–ï–§–õ–ï–ö–°–ò–Ø */
        .nature-chat { 
            background: #e8f5e9; border: 2px solid var(--green); border-radius: 15px; 
            padding: 20px; max-height: 300px; overflow-y: auto; margin-bottom: 10px;
        }
        .chat-bubble { 
            background: white; padding: 10px 15px; border-radius: 20px 20px 20px 0; 
            margin-bottom: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); width: fit-content;
        }
        .chat-bubble.nature { 
            background: var(--green); color: white; border-radius: 20px 20px 0 20px; 
            margin-left: auto; text-align: right; 
        }
    </style>
</head>
<body>

<header>
    <a href="../index.html" class="back-btn">‚Üê –ú–µ–Ω—é</a>
    <div style="text-align: right">
        <h1 style="margin:0; font-size: 1.5rem;">–ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥—ã</h1>
        <small>–£—Ä–æ–∫ ‚Ññ14</small>
    </div>
</header>

<div class="content">
    
    <section>
        <h2>üè≠ –û–ø–∞—Å–Ω—ã–π —Å–ª–µ–¥</h2>
        <p><i>–í–æ–ø—Ä–æ—Å:</i> –ß—Ç–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –≤—Ä–µ–¥–∏—Ç –Ω–∞—à–µ–π –ø–ª–∞–Ω–µ—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å? –î—ã–º, –ø–ª–∞—Å—Ç–∏–∫ –∏–ª–∏ –±–µ–∑—Ä–∞–∑–ª–∏—á–∏–µ?</p>
        <div style="background: #eceff1; padding: 15px; border-radius: 10px; border-left: 5px solid var(--accent);">
            <strong>–¶–µ–ª—å:</strong> –ü–æ–Ω—è—Ç—å –≤–∏–¥—ã –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–π –∏ –Ω–∞—É—á–∏—Ç—å—Å—è –∏—Ö –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—Ç—å.
        </div>
    </section>

    <section>
        <h2>üì∏ –ß—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ?</h2>
        <p>–Ø –æ–ø–∏—à—É –ø—Ä–æ–±–ª–µ–º—É, –∞ –≤—ã —É–≥–∞–¥–∞–π—Ç–µ –≤–∏–¥ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è.</p>
        <div class="photo-quiz">
            <div class="photo-box" id="quizImg">üè≠</div>
            <div class="quiz-btns">
                <button onclick="checkImg('air')">–í–æ–∑–¥—É—Ö</button>
                <button onclick="checkImg('water')">–í–æ–¥–∞</button>
                <button onclick="checkImg('plastic')">–ü–ª–∞—Å—Ç–∏–∫</button>
            </div>
            <p id="imgMsg" style="height:20px; font-weight:bold;"></p>
        </div>
    </section>

    <section>
        <h2>üìö –í–∏–¥—ã –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–π</h2>
        <div style="display:flex; gap:10px; overflow-x:auto; padding-bottom:10px;">
            <div style="min-width:200px; background:#b0bec5; padding:15px; border-radius:10px; color:white;"><b>üí® –í–æ–∑–¥—É—Ö</b><br>–í—ã–±—Ä–æ—Å—ã, –∞–≤—Ç–æ</div>
            <div style="min-width:200px; background:#4fc3f7; padding:15px; border-radius:10px; color:white;"><b>üíß –í–æ–¥–∞</b><br>–°—Ç–æ–∫–∏, –ø–ª–∞—Å—Ç–∏–∫</div>
            <div style="min-width:200px; background:#8d6e63; padding:15px; border-radius:10px; color:white;"><b>üå± –ü–æ—á–≤–∞</b><br>–°–≤–∞–ª–∫–∏, —è–¥—ã</div>
            <div style="min-width:200px; background:#ffca28; padding:15px; border-radius:10px; color:white;"><b>üîä –®—É–º</b><br>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç, –º—É–∑—ã–∫–∞</div>
        </div>
        <div class="video-wrapper">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/9HcP4ovlTLM?si=fkdG8YKN2elIsFMI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
    </section>

    <section>
        <h2>‚ôªÔ∏è –°–æ—Ä—Ç–∏—Ä–æ–≤–æ—á–Ω–∞—è —Å—Ç–∞–Ω—Ü–∏—è</h2>
        <p>–†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è –ø–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º:</p>
        
        <div class="classifier-game">
            <div class="draggables-pool" id="pool">
                <div class="drag-item" draggable="true" ondragstart="drag(event)" id="d1" data-type="air">üöó –í—ã—Ö–ª–æ–ø—ã</div>
                <div class="drag-item" draggable="true" ondragstart="drag(event)" id="d2" data-type="water">üõ¢Ô∏è –ù–µ—Ñ—Ç—å</div>
                <div class="drag-item" draggable="true" ondragstart="drag(event)" id="d3" data-type="soil">üîã –ë–∞—Ç–∞—Ä–µ–π–∫–∏</div>
                <div class="drag-item" draggable="true" ondragstart="drag(event)" id="d4" data-type="noise">üîä –°—Ç—Ä–æ–π–∫–∞</div>
                <div class="drag-item" draggable="true" ondragstart="drag(event)" id="d5" data-type="light">üí° –†–µ–∫–ª–∞–º–∞</div>
                <div class="drag-item" draggable="true" ondragstart="drag(event)" id="d6" data-type="water">üß¥ –°—Ç–æ–∫–∏</div>
                <div class="drag-item" draggable="true" ondragstart="drag(event)" id="d7" data-type="air">üè≠ –î—ã–º</div>
            </div>

            <div class="drop-zones">
                <div class="zone zone-air" ondrop="drop(event, 'air')" ondragover="allowDrop(event)"><h4>–í–æ–∑–¥—É—Ö</h4></div>
                <div class="zone zone-water" ondrop="drop(event, 'water')" ondragover="allowDrop(event)"><h4>–í–æ–¥–∞</h4></div>
                <div class="zone zone-soil" ondrop="drop(event, 'soil')" ondragover="allowDrop(event)"><h4>–ü–æ—á–≤–∞</h4></div>
                <div class="zone zone-noise" ondrop="drop(event, 'noise')" ondragover="allowDrop(event)"><h4>–®—É–º</h4></div>
                <div class="zone zone-light" ondrop="drop(event, 'light')" ondragover="allowDrop(event)"><h4>–°–≤–µ—Ç</h4></div>
            </div>
            <p id="gameMsg" style="text-align:center; font-weight:bold; height:20px;"></p>
        </div>
    </section>

    <section id="worksheets-container">
        <h2>üìù –ê–Ω–∞–ª–∏–∑ –∏ –†–µ—à–µ–Ω–∏—è (Word)</h2>
        <p>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –∏ —Å–∫–∞—á–∞–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.</p>

        <details class="worksheet" open>
            <summary class="worksheet-header">üìÑ –õ–ò–°–¢ 1 ‚Äî ¬´–û–ø—Ä–µ–¥–µ–ª–∏ –≤–∏–¥¬ª</summary>
            <div class="sheet-content">
                <table class="sheet-table">
                    <tr><th>–°–∏—Ç—É–∞—Ü–∏—è</th><th>–í–∏–¥ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è</th><th>–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è</th></tr>
                    <tr><td>–ú—É—Å–æ—Ä –≤ –ª–µ—Å—É</td><td><input type="text"></td><td><input type="text"></td></tr>
                    <tr><td>–î—ã–º –º–∞—à–∏–Ω</td><td><input type="text"></td><td><input type="text"></td></tr>
                    <tr><td>–ì—Ä–æ–º–∫–∞—è –º—É–∑—ã–∫–∞</td><td><input type="text"></td><td><input type="text"></td></tr>
                    <tr><td>–°—Ç–æ–∫–∏ –≤ —Ä–µ–∫—É</td><td><input type="text"></td><td><input type="text"></td></tr>
                </table>
            </div>
        </details>

        <details class="worksheet">
            <summary class="worksheet-header">üí° –õ–ò–°–¢ 2 ‚Äî ¬´–ú–æ–∏ —Ä–µ—à–µ–Ω–∏—è¬ª</summary>
            <div class="sheet-content">
                <p>–ö–∞–∫ —É–º–µ–Ω—å—à–∏—Ç—å –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –≤–æ–∑–¥—É—Ö–∞?</p>
                <textarea class="sheet-area" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –•–æ–¥–∏—Ç—å –ø–µ—à–∫–æ–º..."></textarea>
                <p>–ö–∞–∫ —É–º–µ–Ω—å—à–∏—Ç—å –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –≤–æ–¥—ã?</p>
                <textarea class="sheet-area"></textarea>
            </div>
        </details>

        <details class="worksheet">
            <summary class="worksheet-header">üèôÔ∏è –õ–ò–°–¢ 3 ‚Äî ¬´–ê–Ω–∞–ª–∏–∑ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏¬ª</summary>
            <div class="sheet-content">
                <div class="checkbox-group">
                    <p>–ß—Ç–æ —è –≤–∏–∂—É –≤–æ–∫—Ä—É–≥ –∫–æ–ª–ª–µ–¥–∂–∞/–¥–æ–º–∞?</p>
                    <label><input type="checkbox"> –ú—É—Å–æ—Ä –Ω–∞ –∑–µ–º–ª–µ</label>
                    <label><input type="checkbox"> –í—ã—Ö–ª–æ–ø—ã –º–∞—à–∏–Ω</label>
                    <label><input type="checkbox"> –®—É–º</label>
                    <label><input type="checkbox"> –ß–∏—Å—Ç—ã–µ –≥–∞–∑–æ–Ω—ã</label>
                    <label><input type="checkbox"> –£—Ä–Ω—ã –¥–ª—è –º—É—Å–æ—Ä–∞</label>
                </div>
                <p>–í—ã–≤–æ–¥:</p>
                <textarea class="sheet-area"></textarea>
            </div>
        </details>

        <button class="btn-download" onclick="generateAndDownloadWord()">üì• –°–∫–∞—á–∞—Ç—å –æ—Ç—á–µ—Ç (Word)</button>
    </section>

    <section>
        <h2>üß† –¢–µ—Å—Ç: –≠–∫–æ-—ç–∫—Å–ø–µ—Ä—Ç</h2>
        <form id="quizForm">
            <div class="quiz-item">1. –ß—Ç–æ –∑–∞–≥—Ä—è–∑–Ω—è–µ—Ç –≤–æ–∑–¥—É—Ö? <br><input type="radio" name="q1" value="b"> –î—ã–º –º–∞—à–∏–Ω <input type="radio" name="q1" value="a"> –ú—É—Å–æ—Ä –≤ —Ä–µ–∫–µ</div>
            <div class="quiz-item">2. –ü–ª–∞—Å—Ç–∏–∫ —Ä–∞–∑–ª–∞–≥–∞–µ—Ç—Å—è: <br><input type="radio" name="q2" value="c"> 100-500 –ª–µ—Ç <input type="radio" name="q2" value="a"> 1 –≥–æ–¥</div>
            <div class="quiz-item">3. –®—É–º–æ–≤–æ–µ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ —ç—Ç–æ: <br><input type="radio" name="q3" value="b"> –ì—Ä–æ–º–∫–∏–µ –∑–≤—É–∫–∏ <input type="radio" name="q3" value="a"> –Ø—Ä–∫–∏–π —Å–≤–µ—Ç</div>
            <div class="quiz-item">4. –ö–∞–∫ –ø–æ–º–æ—á—å –≤–æ–∑–¥—É—Ö—É? <br><input type="radio" name="q4" value="a"> –û–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç <input type="radio" name="q4" value="b"> –°–∂–∏–≥–∞—Ç—å –ª–∏—Å—Ç—å—è</div>
            <button type="button" class="btn-check" onclick="checkQuiz()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
            <p id="quiz-result" style="font-weight:bold; margin-top:10px;"></p>
        </form>
    </section>

    <section>
        <h2>üçÉ –ï—Å–ª–∏ –±—ã —è –±—ã–ª –ü—Ä–∏—Ä–æ–¥–æ–π...</h2>
        <p>–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∏–º–µ–Ω–∏ –ü—Ä–∏—Ä–æ–¥—ã. –ß—Ç–æ –±—ã –æ–Ω–∞ —Å–∫–∞–∑–∞–ª–∞ –ª—é–¥—è–º?</p>
        <div class="nature-chat" id="chatBox">
            <div class="chat-bubble">–ß–µ–ª–æ–≤–µ–∫, —è —É—Å—Ç–∞–ª–∞ –æ—Ç –¥—ã–º–∞...</div>
        </div>
        <div style="display:flex; gap:10px;">
            <input type="text" id="chatInput" class="sheet-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
            <button class="btn-check" onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
    </section>
</div>

<script>
    // --- –ò–ì–†–ê 1: –§–æ—Ç–æ-–∫–≤–∏–∑ ---
    const quizData = [
        { icon: "üè≠", type: "air", correct: "–í–æ–∑–¥—É—Ö! –í—ã–±—Ä–æ—Å—ã –∑–∞–≤–æ–¥–æ–≤." },
        { icon: "ü•§", type: "plastic", correct: "–ü–ª–∞—Å—Ç–∏–∫! –í–µ—á–Ω—ã–π –º—É—Å–æ—Ä." },
        { icon: "üõ¢Ô∏è", type: "water", correct: "–í–æ–¥–∞! –†–∞–∑–ª–∏–≤ –Ω–µ—Ñ—Ç–∏." }
    ];
    let quizIdx = 0;

    function checkImg(choice) {
        const current = quizData[quizIdx];
        const msg = document.getElementById('imgMsg');
        
        if(choice === current.type) {
            msg.innerText = current.correct;
            msg.style.color = "green";
            quizIdx = (quizIdx + 1) % quizData.length;
            setTimeout(() => {
                document.getElementById('quizImg').innerText = quizData[quizIdx].icon;
                msg.innerText = "";
            }, 1500);
        } else {
            msg.innerText = "–û—à–∏–±–∫–∞. –ü–æ–¥—É–º–∞–π –µ—â–µ.";
            msg.style.color = "red";
        }
    }

    // --- –ò–ì–†–ê 2: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä (Drag & Drop) ---
    function drag(ev) {
        ev.dataTransfer.setData("id", ev.target.id);
        ev.dataTransfer.setData("type", ev.target.dataset.type);
    }
    function allowDrop(ev) { ev.preventDefault(); }
    function drop(ev, zoneType) {
        ev.preventDefault();
        const id = ev.dataTransfer.getData("id");
        const itemType = ev.dataTransfer.getData("type");
        const el = document.getElementById(id);
        const msg = document.getElementById('gameMsg');

        if(itemType === zoneType) {
            ev.currentTarget.appendChild(el);
            el.style.background = "#c8e6c9"; // Green
            el.draggable = false;
            msg.innerText = "–í–µ—Ä–Ω–æ! ‚úÖ";
            msg.style.color = "green";
        } else {
            msg.innerText = "–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä! ‚ùå";
            msg.style.color = "red";
        }
    }

    // --- WORD ---
    function generateAndDownloadWord() {
        const container = document.getElementById('worksheets-container');
        const clone = container.cloneNode(true);
        clone.querySelector('button').remove(); clone.querySelector('h2').remove(); clone.querySelector('p').remove();
        
        clone.querySelectorAll('input, textarea').forEach(input => {
            const span = document.createElement('span');
            span.style.color = 'blue'; span.style.fontWeight = 'bold';
            if (input.type === 'checkbox') span.innerText = input.checked ? '‚òí ' : '‚òê ';
            else span.innerText = input.value || "______________________";
            input.replaceWith(span);
        });

        clone.querySelectorAll('details').forEach(det => {
            const title = det.querySelector('summary').innerText;
            const div = document.createElement('div');
            div.innerHTML = `<h3 style="background:#eee; border-bottom:1px solid #000; padding:5px;">${title}</h3>` + det.querySelector('.sheet-content').innerHTML;
            det.replaceWith(div);
        });

        const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>–û—Ç—á–µ—Ç</title></head><body>";
        const footer = "</body></html>";
        const content = `<h1 style="text-align:center;color:#455a64">–ê–Ω–∞–ª–∏–∑ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–π</h1>` + clone.innerHTML;
        
        const blob = new Blob(['\ufeff', header + content + footer], { type: 'application/msword' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a'); link.href = url; link.download = '–≠–∫–æ_–ê–Ω–∞–ª–∏–∑.doc';
        document.body.appendChild(link); link.click(); document.body.removeChild(link);
    }

    // --- –¢–ï–°–¢ ---
    function checkQuiz() {
        const form = document.getElementById('quizForm');
        let score = 0;
        if(form.q1.value === 'b') score++;
        if(form.q2.value === 'c') score++;
        if(form.q3.value === 'b') score++;
        if(form.q4.value === 'a') score++;
        const res = document.getElementById('quiz-result');
        res.innerText = `–†–µ–∑—É–ª—å—Ç–∞—Ç: ${score}/4. ` + (score===4 ? "–û—Ç–ª–∏—á–Ω–æ!" : "–ü–æ–≤—Ç–æ—Ä–∏ —Ç–µ–º—É.");
        res.style.color = score===4 ? "green" : "red";
    }

    // --- –†–ï–§–õ–ï–ö–°–ò–Ø ---
    function sendMessage() {
        const input = document.getElementById('chatInput');
        const text = input.value.trim();
        if(text) {
            const box = document.getElementById('chatBox');
            const bubble = document.createElement('div');
            bubble.className = 'chat-bubble nature';
            bubble.innerText = text;
            box.appendChild(bubble);
            input.value = '';
            box.scrollTop = box.scrollHeight; // Auto scroll
        }
    }
</script>

</body>
</html>